---
title: "Final Proposal"
author: "Dev Desai, Thanh Mai, Shobhit Sarkar, Brian Xicon"
output: html_document
date: "2023-11-13"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

# Description:
The dataset we are using is a list of all active businesses from the City of Los Angeles. The fields include the account number, business name, DBA name, street address, city, zip code, location description, mailing address, mailing city, mailing zip code, primary NAICS description (what the company does), NAICS (code of what the company does), council district, location start date, location end date, and lastly the actual location as coordinates. It has more than 580000 companies in this dataset. We got this dataset from [https://catalog.data.gov/dataset/listing-of-active-businesses]

```{r, cache=TRUE}
# Download the csv from the source, if not already on disk.
# The file is 125 MB, which might take up to a minute to download.

if (!file.exists("Listing_of_Active_Businesses.csv")) {
  # URL is a CDN link, which is served by https://catalog.data.gov/dataset/listing-of-active-businesses
  url <- "https://data.lacity.org/api/views/6rrh-rzua/rows.csv?accessType=DOWNLOAD"
  download.file(url, "Listing_of_Active_Businesses.csv", mode = "wb")
}
businesses <- read.csv("Listing_of_Active_Businesses.csv")
cat("Number of rows in data: ", nrow(businesses), ". Expected 582k rows", sep="")
```


# First Data Cleaning Steps:
```{r}
# Converting dates to Date objects
businesses$LOCATION.START.DATE <- as.Date(businesses$LOCATION.START.DATE, format = "%m/%d/%Y")
businesses$LOCATION.END.DATE <- as.Date(businesses$LOCATION.END.DATE, format = "%m/%d/%Y")

# Removing duplicate rows
businesses <- businesses %>% distinct()

head(businesses)
```


# Marginal Summaries:
```{r}
# Some basic numerical marginal summaries
numeric_summaries <- businesses %>%
  summarise(
    StartDateEarliest = min(LOCATION.START.DATE, na.rm = TRUE),
    StartDateLatest = max(LOCATION.START.DATE, na.rm = TRUE),
  )
numeric_summaries
```

```{r}
# Some basic categorical marginal summaries
categorical_summaries <- businesses %>%
  filter(!is.na(PRIMARY.NAICS.DESCRIPTION) & PRIMARY.NAICS.DESCRIPTION != "") %>%
  summarise(
    MostCommonCity = names(which.max(table(CITY))),
    MostCommonNAICS = names(which.max(table(PRIMARY.NAICS.DESCRIPTION)))
  )

categorical_summaries
```

# Exploration plan:
## Potential research questions:
1. What types of businesses are more common? Is there a trend over time?
2. Are there any time periods with more or less active businesses? Why?
3. Can we integrate geographic data into the dataset? Do businesses gravitate towards certain regions? Why?
4. How is the distribution of different business types evolving over time within each council district? Are new industries emerging in specific districts?
5. Are there seasonal or annual trends in the number of new business registrations, and can these be linked to economic cycles or local events?
## Steps:
- Do data cleaning, especially on the NAICS code and description (business type/industry).
- Plot various variables across time, both linearly and seasonally.
- Find additional economic data (either nationally or locally), and find correlations.
- Get additional geographic data around the Los Angeles metropolitan area, for instance, population distribution by district.
- Plot the distribution of businesses on a map, perhaps also create a choropleth (if only district data) or heatmap (if more granular data is available) to show tendencies in distribution.
- Find correlations between variables in the district data and what types of businesses are more active in those areas.
- For any given correlation that is of research interest, can we predict business activity using that given set of variables? Try predictions using both regression methods and machine learning techniques.
- Does our prediction/hypothesis make sense? Can we prove it, perhaps by looking at other areas or on a nation-wide scale?

```{r}
# Sample 1000 random businesses to reduce computation time.
# Use during development, but switch back to the full dataset when done.
businesses_trunc <- head(businesses, 1000)
```

